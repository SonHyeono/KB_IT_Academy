```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
```


```python
# from google.colab import files
# uploaded = files.upload()

```


```python
df = pd.read_csv('./남자/Male_volleyball.csv')
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>팀명</th>
      <th>경기날짜</th>
      <th>결과</th>
      <th>이름</th>
      <th>공격종합_성공률</th>
      <th>오픈_성공률</th>
      <th>후위_성공률</th>
      <th>속공_성공률</th>
      <th>퀵오픈_성공률</th>
      <th>서브_성공률</th>
      <th>디그_시도</th>
      <th>디그_성공</th>
      <th>세트_시도</th>
      <th>세트_성공</th>
      <th>블로킹_시도</th>
      <th>블로킹_성공</th>
      <th>범실_범실</th>
      <th>포지션</th>
      <th>득점점유율</th>
      <th>스타팅멤버</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>현대캐피탈</td>
      <td>2017-10-14</td>
      <td>1</td>
      <td>안드레아스</td>
      <td>61.76</td>
      <td>60.00</td>
      <td>75.00</td>
      <td>0.00</td>
      <td>53.33</td>
      <td>0.00</td>
      <td>6</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>12</td>
      <td>2</td>
      <td>10</td>
      <td>L</td>
      <td>0.338235</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>현대캐피탈</td>
      <td>2017-10-14</td>
      <td>1</td>
      <td>문성민</td>
      <td>53.13</td>
      <td>45.45</td>
      <td>46.15</td>
      <td>0.00</td>
      <td>71.43</td>
      <td>0.25</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>7</td>
      <td>0</td>
      <td>7</td>
      <td>R</td>
      <td>0.264706</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>현대캐피탈</td>
      <td>2017-10-14</td>
      <td>1</td>
      <td>신영석</td>
      <td>50.00</td>
      <td>50.00</td>
      <td>0.00</td>
      <td>50.00</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>11</td>
      <td>5</td>
      <td>1</td>
      <td>C</td>
      <td>0.147059</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>현대캐피탈</td>
      <td>2017-10-14</td>
      <td>1</td>
      <td>김재휘</td>
      <td>50.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>50.00</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>10</td>
      <td>2</td>
      <td>5</td>
      <td>C</td>
      <td>0.102941</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>현대캐피탈</td>
      <td>2017-10-14</td>
      <td>1</td>
      <td>이시우</td>
      <td>75.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>100.00</td>
      <td>0.25</td>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>L</td>
      <td>0.102941</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11014</th>
      <td>OK금융그룹</td>
      <td>2022-02-13</td>
      <td>1</td>
      <td>박원빈</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4</td>
      <td>3</td>
      <td>5</td>
      <td>1</td>
      <td>13</td>
      <td>1</td>
      <td>1</td>
      <td>C</td>
      <td>0.019608</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11015</th>
      <td>OK금융그룹</td>
      <td>2022-02-13</td>
      <td>1</td>
      <td>진상헌</td>
      <td>33.33</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>33.33</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>C</td>
      <td>0.019608</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11016</th>
      <td>OK금융그룹</td>
      <td>2022-02-13</td>
      <td>1</td>
      <td>전병선</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.33</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>R</td>
      <td>0.019608</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11017</th>
      <td>OK금융그룹</td>
      <td>2022-02-13</td>
      <td>1</td>
      <td>부용찬</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>8</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Li</td>
      <td>0.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11018</th>
      <td>OK금융그룹</td>
      <td>2022-02-13</td>
      <td>1</td>
      <td>조국기</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>5</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>Li</td>
      <td>0.000000</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>11019 rows × 20 columns</p>
</div>



# 이름의 경우 중복이 있을 수도 있으니 팀명_이름 조합으로 기본키 만들기


```python
df['이름'] = df['팀명'] + "_" + df['이름']
```

## # 5년동안 팀명 수정 : OK저축은행이 OK금융그룹으로 변경한 것만 존재.


```python
cond = df['팀명'] =='OK저축은행'
```


```python
df.loc[cond,['팀명']] = 'OK금융그룹'

```


```python
# 경기날짜의 데이터타입 변경 (datetime64)
df['경기날짜'] = df['경기날짜'].astype('datetime64')
df.dtypes
```




    팀명                  object
    경기날짜        datetime64[ns]
    결과                   int64
    이름                  object
    공격종합_성공률           float64
    오픈_성공률             float64
    후위_성공률             float64
    속공_성공률             float64
    퀵오픈_성공률            float64
    서브_성공률             float64
    디그_시도                int64
    디그_성공                int64
    세트_시도                int64
    세트_성공                int64
    블로킹_시도               int64
    블로킹_성공               int64
    범실_범실                int64
    포지션                 object
    득점점유율              float64
    스타팅멤버                int64
    dtype: object




```python
df['세트_성공률'] = round(df['세트_성공']/df['세트_시도']*100, 2)
df['블로킹_성공률'] = round(df['블로킹_성공']/df['블로킹_시도']*100, 2)
df['디그_성공률'] = round(df['디그_성공']/df['디그_시도']*100, 2)
```


```python
df['포지션'].unique()
```




    array(['L', 'R', 'C', 'S', 'Li', '오켈로'], dtype=object)



# 레프트(Left side hitter, L), 2명

**공격종합_성공률**

# 라이트(Right side hitter, R), 1명

수비 가담은 적고, 

**공격종합_성공률**


# 센터(Center), 2명

블록킹 능력 중요, 

**블로킹_성공률**

# 세터(Setter), 1명

코트 위의 지휘자, 세터의 토스가 공격에서 중요
리시버, 디거 중요!

**디그_성공률**

# 리베로(Libero), 1명

수비 중요, 

**디그_성공률**

## 선수의 포지션별 등급을 매기기, ( 스타팅멤버가 아닌 사람이 출전할 수도 있으니 스타팅멤버로 하지않음 )


```python
df.fillna(0, inplace=True)
```


```python
df_player = df.groupby(['이름', '포지션'])[['공격종합_성공률', '블로킹_성공률', '디그_성공률']].mean()
df_player
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>공격종합_성공률</th>
      <th>블로킹_성공률</th>
      <th>디그_성공률</th>
    </tr>
    <tr>
      <th>이름</th>
      <th>포지션</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KB손해보험_강영준</th>
      <th>R</th>
      <td>51.514</td>
      <td>21.0955</td>
      <td>61.984500</td>
    </tr>
    <tr>
      <th>KB손해보험_곽동혁</th>
      <th>Li</th>
      <td>0.000</td>
      <td>0.0000</td>
      <td>80.850172</td>
    </tr>
    <tr>
      <th>KB손해보험_구도현</th>
      <th>C</th>
      <td>42.500</td>
      <td>33.8500</td>
      <td>66.666667</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">KB손해보험_김도훈</th>
      <th>L</th>
      <td>0.000</td>
      <td>0.0000</td>
      <td>51.190714</td>
    </tr>
    <tr>
      <th>Li</th>
      <td>0.000</td>
      <td>0.0000</td>
      <td>85.628571</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>현대캐피탈_홍동선</th>
      <th>L</th>
      <td>55.030</td>
      <td>0.0000</td>
      <td>88.890000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">현대캐피탈_홍민기</th>
      <th>C</th>
      <td>13.750</td>
      <td>18.7500</td>
      <td>25.000000</td>
    </tr>
    <tr>
      <th>R</th>
      <td>0.000</td>
      <td>0.0000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>현대캐피탈_황동일</th>
      <th>S</th>
      <td>25.000</td>
      <td>15.4645</td>
      <td>49.944500</td>
    </tr>
    <tr>
      <th>현대캐피탈_히메네즈</th>
      <th>R</th>
      <td>54.781</td>
      <td>10.3330</td>
      <td>59.571000</td>
    </tr>
  </tbody>
</table>
<p>355 rows × 3 columns</p>
</div>




```python
df_player.reset_index(level=['이름'], inplace = True)
df_player.reset_index(level=['포지션'], inplace = True)

df_player
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>포지션</th>
      <th>이름</th>
      <th>공격종합_성공률</th>
      <th>블로킹_성공률</th>
      <th>디그_성공률</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>R</td>
      <td>KB손해보험_강영준</td>
      <td>51.514</td>
      <td>21.0955</td>
      <td>61.984500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Li</td>
      <td>KB손해보험_곽동혁</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>80.850172</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>KB손해보험_구도현</td>
      <td>42.500</td>
      <td>33.8500</td>
      <td>66.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>L</td>
      <td>KB손해보험_김도훈</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>51.190714</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Li</td>
      <td>KB손해보험_김도훈</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>85.628571</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>350</th>
      <td>L</td>
      <td>현대캐피탈_홍동선</td>
      <td>55.030</td>
      <td>0.0000</td>
      <td>88.890000</td>
    </tr>
    <tr>
      <th>351</th>
      <td>C</td>
      <td>현대캐피탈_홍민기</td>
      <td>13.750</td>
      <td>18.7500</td>
      <td>25.000000</td>
    </tr>
    <tr>
      <th>352</th>
      <td>R</td>
      <td>현대캐피탈_홍민기</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>353</th>
      <td>S</td>
      <td>현대캐피탈_황동일</td>
      <td>25.000</td>
      <td>15.4645</td>
      <td>49.944500</td>
    </tr>
    <tr>
      <th>354</th>
      <td>R</td>
      <td>현대캐피탈_히메네즈</td>
      <td>54.781</td>
      <td>10.3330</td>
      <td>59.571000</td>
    </tr>
  </tbody>
</table>
<p>355 rows × 5 columns</p>
</div>




```python
# df_player[df_player['포지션'] == 'L'][['공격종합_성공률']].agg(['mean',])

att = df_player.groupby('포지션')[['공격종합_성공률']].describe()
att
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">공격종합_성공률</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>포지션</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C</th>
      <td>83.0</td>
      <td>50.647503</td>
      <td>16.034362</td>
      <td>0.00</td>
      <td>45.300039</td>
      <td>52.840676</td>
      <td>58.671548</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>L</th>
      <td>118.0</td>
      <td>29.859876</td>
      <td>21.618399</td>
      <td>0.00</td>
      <td>0.378788</td>
      <td>38.337269</td>
      <td>49.170424</td>
      <td>57.140000</td>
    </tr>
    <tr>
      <th>Li</th>
      <td>56.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>R</th>
      <td>53.0</td>
      <td>38.202549</td>
      <td>18.353695</td>
      <td>0.00</td>
      <td>20.609796</td>
      <td>46.725000</td>
      <td>51.514000</td>
      <td>56.046364</td>
    </tr>
    <tr>
      <th>S</th>
      <td>44.0</td>
      <td>20.040845</td>
      <td>15.792341</td>
      <td>0.00</td>
      <td>3.703681</td>
      <td>18.933300</td>
      <td>31.307870</td>
      <td>55.555556</td>
    </tr>
    <tr>
      <th>오켈로</th>
      <td>1.0</td>
      <td>46.150000</td>
      <td>NaN</td>
      <td>46.15</td>
      <td>46.150000</td>
      <td>46.150000</td>
      <td>46.150000</td>
      <td>46.150000</td>
    </tr>
  </tbody>
</table>
</div>




```python
att = att['공격종합_성공률'][['25%', '50%' ,'75%']]
att.reset_index(level = ['포지션'], inplace=True)
att
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>포지션</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>45.300039</td>
      <td>52.840676</td>
      <td>58.671548</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L</td>
      <td>0.378788</td>
      <td>38.337269</td>
      <td>49.170424</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Li</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>R</td>
      <td>20.609796</td>
      <td>46.725000</td>
      <td>51.514000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S</td>
      <td>3.703681</td>
      <td>18.933300</td>
      <td>31.307870</td>
    </tr>
    <tr>
      <th>5</th>
      <td>오켈로</td>
      <td>46.150000</td>
      <td>46.150000</td>
      <td>46.150000</td>
    </tr>
  </tbody>
</table>
</div>




```python
block = df_player.groupby('포지션')[['블로킹_성공률']].describe()
block = block['블로킹_성공률'][['25%', '50%' ,'75%']]
block.reset_index(level = ['포지션'], inplace=True)
block
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>포지션</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>13.634730</td>
      <td>17.293770</td>
      <td>20.295705</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L</td>
      <td>0.000000</td>
      <td>9.836945</td>
      <td>16.656982</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Li</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>R</td>
      <td>10.333000</td>
      <td>17.804054</td>
      <td>22.425143</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S</td>
      <td>4.967672</td>
      <td>11.708436</td>
      <td>16.144605</td>
    </tr>
    <tr>
      <th>5</th>
      <td>오켈로</td>
      <td>50.000000</td>
      <td>50.000000</td>
      <td>50.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
dig = df_player.groupby('포지션')[['디그_성공률']].describe()
dig = dig['디그_성공률'][['25%', '50%' ,'75%']]
dig.reset_index(level = ['포지션'], inplace=True)
dig
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>포지션</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>53.380000</td>
      <td>62.083500</td>
      <td>70.152779</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L</td>
      <td>40.416875</td>
      <td>62.507284</td>
      <td>72.703539</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Li</td>
      <td>71.591569</td>
      <td>75.575392</td>
      <td>81.769237</td>
    </tr>
    <tr>
      <th>3</th>
      <td>R</td>
      <td>33.333333</td>
      <td>64.099259</td>
      <td>69.611111</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S</td>
      <td>49.149075</td>
      <td>66.591389</td>
      <td>70.457388</td>
    </tr>
    <tr>
      <th>5</th>
      <td>오켈로</td>
      <td>66.670000</td>
      <td>66.670000</td>
      <td>66.670000</td>
    </tr>
  </tbody>
</table>
</div>



# L 공격종합_성공률

# R 공격종합_성공률

# C 블로킹_성공률

# S 디그_성공률

# Li 디그_성공률


```python
df_player
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>포지션</th>
      <th>이름</th>
      <th>공격종합_성공률</th>
      <th>블로킹_성공률</th>
      <th>디그_성공률</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>R</td>
      <td>KB손해보험_강영준</td>
      <td>51.514</td>
      <td>21.0955</td>
      <td>61.984500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Li</td>
      <td>KB손해보험_곽동혁</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>80.850172</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>KB손해보험_구도현</td>
      <td>42.500</td>
      <td>33.8500</td>
      <td>66.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>L</td>
      <td>KB손해보험_김도훈</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>51.190714</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Li</td>
      <td>KB손해보험_김도훈</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>85.628571</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>350</th>
      <td>L</td>
      <td>현대캐피탈_홍동선</td>
      <td>55.030</td>
      <td>0.0000</td>
      <td>88.890000</td>
    </tr>
    <tr>
      <th>351</th>
      <td>C</td>
      <td>현대캐피탈_홍민기</td>
      <td>13.750</td>
      <td>18.7500</td>
      <td>25.000000</td>
    </tr>
    <tr>
      <th>352</th>
      <td>R</td>
      <td>현대캐피탈_홍민기</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>353</th>
      <td>S</td>
      <td>현대캐피탈_황동일</td>
      <td>25.000</td>
      <td>15.4645</td>
      <td>49.944500</td>
    </tr>
    <tr>
      <th>354</th>
      <td>R</td>
      <td>현대캐피탈_히메네즈</td>
      <td>54.781</td>
      <td>10.3330</td>
      <td>59.571000</td>
    </tr>
  </tbody>
</table>
<p>355 rows × 5 columns</p>
</div>




```python
# df_player['등급'] = 
for i in range(len(df_player)):
    x = df_player.loc[i, :]
    level = 1
    
    arr = []
    
    if x['포지션'] == 'L':
        per2 = att[att['포지션'] == 'L']['25%'].values[0]
        per5 = att[att['포지션'] == 'L']['50%'].values[0]
        per7 = att[att['포지션'] == 'L']['75%'].values[0]
        a = x['공격종합_성공률']
        arr.append(per2)
        arr.append(per5)
        arr.append(per7)
        arr.append(a)
        arr = sorted(arr)
        level = arr.index(a) + 1
    
    if x['포지션'] == 'R':
        per2 = att[att['포지션'] == 'R']['25%'].values[0]
        per5 = att[att['포지션'] == 'R']['50%'].values[0]
        per7 = att[att['포지션'] == 'R']['75%'].values[0]
        a = x['공격종합_성공률']
        arr.append(per2)
        arr.append(per5)
        arr.append(per7)
        arr.append(a)
        arr = sorted(arr)
        level = arr.index(a) + 1
        
    if x['포지션'] == 'C':
        per2 = block[block['포지션'] == 'C']['25%'].values[0]
        per5 = block[block['포지션'] == 'C']['50%'].values[0]
        per7 = block[block['포지션'] == 'C']['75%'].values[0]
        a = x['블로킹_성공률']
        arr.append(per2)
        arr.append(per5)
        arr.append(per7)
        arr.append(a)
        arr = sorted(arr)
        level = arr.index(a) + 1
        
    if x['포지션'] == 'S':
        per2 = block[block['포지션'] == 'S']['25%'].values[0]
        per5 = block[block['포지션'] == 'S']['50%'].values[0]
        per7 = block[block['포지션'] == 'S']['75%'].values[0]
        a = x['디그_성공률']
        arr.append(per2)
        arr.append(per5)
        arr.append(per7)
        arr.append(a)
        arr = sorted(arr)
        level = arr.index(a) + 1
        
    if x['포지션'] == 'Li':
        per2 = block[block['포지션'] == 'S']['25%'].values[0]
        per5 = block[block['포지션'] == 'S']['50%'].values[0]
        per7 = block[block['포지션'] == 'S']['75%'].values[0]
        a = x['디그_성공률']
        arr.append(per2)
        arr.append(per5)
        arr.append(per7)
        arr.append(a)
        arr = sorted(arr)
        level = arr.index(a) + 1
    df_player.loc[i,'등급'] = level 
        
```


```python
df_player
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>포지션</th>
      <th>이름</th>
      <th>공격종합_성공률</th>
      <th>블로킹_성공률</th>
      <th>디그_성공률</th>
      <th>등급</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>R</td>
      <td>KB손해보험_강영준</td>
      <td>51.514</td>
      <td>21.0955</td>
      <td>61.984500</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Li</td>
      <td>KB손해보험_곽동혁</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>80.850172</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>KB손해보험_구도현</td>
      <td>42.500</td>
      <td>33.8500</td>
      <td>66.666667</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>L</td>
      <td>KB손해보험_김도훈</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>51.190714</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Li</td>
      <td>KB손해보험_김도훈</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>85.628571</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>350</th>
      <td>L</td>
      <td>현대캐피탈_홍동선</td>
      <td>55.030</td>
      <td>0.0000</td>
      <td>88.890000</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>351</th>
      <td>C</td>
      <td>현대캐피탈_홍민기</td>
      <td>13.750</td>
      <td>18.7500</td>
      <td>25.000000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>352</th>
      <td>R</td>
      <td>현대캐피탈_홍민기</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>353</th>
      <td>S</td>
      <td>현대캐피탈_황동일</td>
      <td>25.000</td>
      <td>15.4645</td>
      <td>49.944500</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>354</th>
      <td>R</td>
      <td>현대캐피탈_히메네즈</td>
      <td>54.781</td>
      <td>10.3330</td>
      <td>59.571000</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
<p>355 rows × 6 columns</p>
</div>




```python
level_dict = df_player[['이름','등급']]
level_dict = level_dict.set_index('이름').T.to_dict('list')
```

    C:\Users\user\AppData\Local\Temp/ipykernel_15280/1424401569.py:2: UserWarning: DataFrame columns are not unique, some columns will be omitted.
      level_dict = level_dict.set_index('이름').T.to_dict('list')
    


```python
# 세트성공률, 디그 성공률, 블로킹, 퀵오픈공격 성공률
df_v2 = df.loc[df['스타팅멤버'] == 1, ["팀명","이름","경기날짜", "결과", '스타팅멤버']]
df_v2.fillna(0, inplace=True)
df_v2.isna().sum()
```




    팀명       0
    이름       0
    경기날짜     0
    결과       0
    스타팅멤버    0
    dtype: int64




```python
df_v2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>팀명</th>
      <th>이름</th>
      <th>경기날짜</th>
      <th>결과</th>
      <th>스타팅멤버</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>현대캐피탈</td>
      <td>현대캐피탈_안드레아스</td>
      <td>2017-10-14</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>현대캐피탈</td>
      <td>현대캐피탈_문성민</td>
      <td>2017-10-14</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>현대캐피탈</td>
      <td>현대캐피탈_신영석</td>
      <td>2017-10-14</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>현대캐피탈</td>
      <td>현대캐피탈_김재휘</td>
      <td>2017-10-14</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>현대캐피탈</td>
      <td>현대캐피탈_박주형</td>
      <td>2017-10-14</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11010</th>
      <td>OK금융그룹</td>
      <td>OK금융그룹_차지환</td>
      <td>2022-02-13</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11011</th>
      <td>OK금융그룹</td>
      <td>OK금융그룹_곽명우</td>
      <td>2022-02-13</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11013</th>
      <td>OK금융그룹</td>
      <td>OK금융그룹_박승수</td>
      <td>2022-02-13</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11014</th>
      <td>OK금융그룹</td>
      <td>OK금융그룹_박원빈</td>
      <td>2022-02-13</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11015</th>
      <td>OK금융그룹</td>
      <td>OK금융그룹_진상헌</td>
      <td>2022-02-13</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>6760 rows × 5 columns</p>
</div>




```python
plt.rcParams['font.family'] = "Malgun Gothic"
plt.figure(figsize=(20,10))
p = sns.countplot(data = df_v2.loc[:,['팀명', '결과']],x = '팀명', hue='결과'  )
p.set_xlabel('팀명', fontsize=20) 
p.set_ylabel('count',fontsize=20)


plt.show()
```


    
![output_27_0](https://user-images.githubusercontent.com/26592315/164895979-9f489928-7148-42f0-bb7e-f9e98ab9e814.png)

    



```python
df_v2 = df_v2.groupby(['경기날짜', '팀명'])[['이름', '결과']].agg({'이름' : lambda data : ' '.join(data), '결과' : any})
df_v2 = pd.DataFrame(df_v2).reset_index()
df_v2.head()
```





  <div id="df-a4a6b745-cfb5-4446-9026-537daeceb2e3">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>경기날짜</th>
      <th>팀명</th>
      <th>이름</th>
      <th>결과</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-10-14</td>
      <td>대한항공</td>
      <td>대한항공_가스파리니 대한항공_곽승석 대한항공_정지석 대한항공_진상헌 대한항공_조재영...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-10-14</td>
      <td>현대캐피탈</td>
      <td>현대캐피탈_안드레아스 현대캐피탈_문성민 현대캐피탈_신영석 현대캐피탈_김재휘 현대캐피...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-10-15</td>
      <td>KB손해보험</td>
      <td>KB손해보험_알렉스 KB손해보험_이강원 KB손해보험_황두연 KB손해보험_이선규 KB...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-10-15</td>
      <td>삼성화재</td>
      <td>삼성화재_박철우 삼성화재_타이스 삼성화재_김규민 삼성화재_류윤식 삼성화재_박상하 삼...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-10-17</td>
      <td>OK금융그룹</td>
      <td>OK저축은행_브람 OK저축은행_송명근 OK저축은행_송희채 OK저축은행_이민규 OK저...</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a4a6b745-cfb5-4446-9026-537daeceb2e3')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a4a6b745-cfb5-4446-9026-537daeceb2e3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a4a6b745-cfb5-4446-9026-537daeceb2e3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
pd.set_option('mode.chained_assignment',  None) 
for i in range(len(df_v2)):
    df_v2['이름'][i] = ' '.join(df_v2['이름'][i].split()[:6])
    
df_v2.head()
```





  <div id="df-0b0ab2b6-675d-4fac-9489-6cdcf921a331">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>경기날짜</th>
      <th>팀명</th>
      <th>이름</th>
      <th>결과</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-10-14</td>
      <td>대한항공</td>
      <td>대한항공_가스파리니 대한항공_곽승석 대한항공_정지석 대한항공_진상헌 대한항공_조재영...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-10-14</td>
      <td>현대캐피탈</td>
      <td>현대캐피탈_안드레아스 현대캐피탈_문성민 현대캐피탈_신영석 현대캐피탈_김재휘 현대캐피...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-10-15</td>
      <td>KB손해보험</td>
      <td>KB손해보험_알렉스 KB손해보험_이강원 KB손해보험_황두연 KB손해보험_이선규 KB...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-10-15</td>
      <td>삼성화재</td>
      <td>삼성화재_박철우 삼성화재_타이스 삼성화재_김규민 삼성화재_류윤식 삼성화재_박상하 삼...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-10-17</td>
      <td>OK금융그룹</td>
      <td>OK저축은행_브람 OK저축은행_송명근 OK저축은행_송희채 OK저축은행_이민규 OK저...</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0b0ab2b6-675d-4fac-9489-6cdcf921a331')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0b0ab2b6-675d-4fac-9489-6cdcf921a331 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0b0ab2b6-675d-4fac-9489-6cdcf921a331');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
# 경기번호 추가
import numpy as np
total = df_v2.shape[0] // 2
df_v2['경기번호'] = np.array([[i,i] for i in range(1, total+1)]).flatten()
df_v2.head()
```





  <div id="df-3e12bffb-1ff9-4f69-9e47-a96ec5256399">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>경기날짜</th>
      <th>팀명</th>
      <th>이름</th>
      <th>결과</th>
      <th>경기번호</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-10-14</td>
      <td>대한항공</td>
      <td>대한항공_가스파리니 대한항공_곽승석 대한항공_정지석 대한항공_진상헌 대한항공_조재영...</td>
      <td>False</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-10-14</td>
      <td>현대캐피탈</td>
      <td>현대캐피탈_안드레아스 현대캐피탈_문성민 현대캐피탈_신영석 현대캐피탈_김재휘 현대캐피...</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-10-15</td>
      <td>KB손해보험</td>
      <td>KB손해보험_알렉스 KB손해보험_이강원 KB손해보험_황두연 KB손해보험_이선규 KB...</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-10-15</td>
      <td>삼성화재</td>
      <td>삼성화재_박철우 삼성화재_타이스 삼성화재_김규민 삼성화재_류윤식 삼성화재_박상하 삼...</td>
      <td>False</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-10-17</td>
      <td>OK금융그룹</td>
      <td>OK저축은행_브람 OK저축은행_송명근 OK저축은행_송희채 OK저축은행_이민규 OK저...</td>
      <td>True</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3e12bffb-1ff9-4f69-9e47-a96ec5256399')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-3e12bffb-1ff9-4f69-9e47-a96ec5256399 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-3e12bffb-1ff9-4f69-9e47-a96ec5256399');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
col = df['팀명'].unique()
col
```




    array(['현대캐피탈', '대한항공', 'KB손해보험', '삼성화재', 'OK금융그룹', '한국전력', '우리카드'],
          dtype=object)




```python
player = ' '.join(df['이름']).split()
player = list(set(player))
```


```python
'삼성화재_노재욱' in player
```




    False




```python
#player는 뒤에서 test에서도 써야하니깐 전역 변수로
# player = []

def df_train(club_name, df_v2, check = False, e = []):
    club = df_v2[df_v2['팀명'] == club_name]['경기번호'].to_frame()
    
    club_score = []
    for i in club['경기번호']:
        x = df_v2[(df_v2[ '경기번호'] == i) & (df_v2['팀명'] != club_name )]
        club_score.append({'경기날짜' : x['경기날짜'].values[0],'팀명' : x['팀명'].values[0] , '이름' : x['이름'].values[0], 
                          '결과' : x['결과'].values[0],'경기번호':x['경기번호'].values[0]})

    club_score = pd.DataFrame(club_score)
    
    club_score.loc[:, player] = 0
        
    
    for i in range(len(club_score)):
        for j in club_score['이름'][i].split():
            try:
                
                club_score[j][i] = level_dict[j][0]
            except:
                continue
    
    club_score = pd.get_dummies(club_score, columns=['팀명'])
    
    club_score = club_score.drop(['경기날짜','경기번호','이름'], axis=1)
    
    club_score['결과'] = np.where(club_score['결과'] == True , 0, 1)
    
    if check == True:
        x_col = e.columns
        y_col = club_score.columns
        complement = list(set(x_col).difference(y_col))
        print(len(complement))
        
        club_score.loc[:, complement]  = 0
    
    

    return(club_score)
        

```


```python
# (['현대캐피탈', '대한항공', 'KB손해보험', '삼성화재', 'OK금융그룹', '한국전력', '우리카드'],
    
df_Capital = df_train('현대캐피탈', df_v2)
df_korea = df_train('대한항공', df_v2)
df_KB = df_train('KB손해보험', df_v2)
df_Sam = df_train('삼성화재', df_v2)
df_OK = df_train('OK금융그룹', df_v2) 
df_KoreaE = df_train('한국전력', df_v2)
df_Woori = df_train('우리카드', df_v2)
```


```python
# !pip install pycaret
```


```python
df_Capital
```





  <div id="df-bff1ba16-3487-41be-a3a8-add4f4e176c6">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>결과</th>
      <th>삼성화재_정수용</th>
      <th>KB손해보험_김홍정</th>
      <th>우리카드_파다르</th>
      <th>KB손해보험_정동근</th>
      <th>KB손해보험_이강원</th>
      <th>한국전력_최홍석</th>
      <th>삼성화재_정준혁</th>
      <th>한국전력_구본승</th>
      <th>OK저축은행_차지환</th>
      <th>...</th>
      <th>우리카드_김완종</th>
      <th>한국전력_김지한</th>
      <th>대한항공_조재영</th>
      <th>삼성화재_산탄젤로</th>
      <th>팀명_KB손해보험</th>
      <th>팀명_OK금융그룹</th>
      <th>팀명_대한항공</th>
      <th>팀명_삼성화재</th>
      <th>팀명_우리카드</th>
      <th>팀명_한국전력</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>173</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>174</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>175</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>176</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>177</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>178 rows × 324 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bff1ba16-3487-41be-a3a8-add4f4e176c6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bff1ba16-3487-41be-a3a8-add4f4e176c6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bff1ba16-3487-41be-a3a8-add4f4e176c6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
from pycaret.classification import *

df_setup = setup(data=df_Capital, target='결과', fold_shuffle=True)
```



  <div id="df-d16225a1-2147-40a8-8f79-2a0b3b6a33ae">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Description</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>session_id</td>
      <td>4419</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Target</td>
      <td>결과</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Target Type</td>
      <td>Binary</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Label Encoded</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Original Data</td>
      <td>(178, 324)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Missing Values</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Numeric Features</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Categorical Features</td>
      <td>317</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Ordinal Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>High Cardinality Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>High Cardinality Method</td>
      <td>None</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Transformed Train Set</td>
      <td>(124, 292)</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Transformed Test Set</td>
      <td>(54, 292)</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Shuffle Train-Test</td>
      <td>True</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Stratify Train-Test</td>
      <td>False</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Fold Generator</td>
      <td>StratifiedKFold</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Fold Number</td>
      <td>10</td>
    </tr>
    <tr>
      <th>17</th>
      <td>CPU Jobs</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Use GPU</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Log Experiment</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Experiment Name</td>
      <td>clf-default-name</td>
    </tr>
    <tr>
      <th>21</th>
      <td>USI</td>
      <td>d4a4</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Imputation Type</td>
      <td>simple</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Iterative Imputation Iteration</td>
      <td>None</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Numeric Imputer</td>
      <td>mean</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Iterative Imputation Numeric Model</td>
      <td>None</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Categorical Imputer</td>
      <td>constant</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Iterative Imputation Categorical Model</td>
      <td>None</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Unknown Categoricals Handling</td>
      <td>least_frequent</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Normalize</td>
      <td>False</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Normalize Method</td>
      <td>None</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Transformation</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Transformation Method</td>
      <td>None</td>
    </tr>
    <tr>
      <th>33</th>
      <td>PCA</td>
      <td>False</td>
    </tr>
    <tr>
      <th>34</th>
      <td>PCA Method</td>
      <td>None</td>
    </tr>
    <tr>
      <th>35</th>
      <td>PCA Components</td>
      <td>None</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Ignore Low Variance</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Combine Rare Levels</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Rare Level Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Numeric Binning</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Remove Outliers</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Outliers Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Remove Multicollinearity</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Multicollinearity Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Remove Perfect Collinearity</td>
      <td>True</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Clustering</td>
      <td>False</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Clustering Iteration</td>
      <td>None</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Polynomial Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Polynomial Degree</td>
      <td>None</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Trignometry Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Polynomial Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Group Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Feature Selection</td>
      <td>False</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Feature Selection Method</td>
      <td>classic</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Features Selection Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Feature Interaction</td>
      <td>False</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Feature Ratio</td>
      <td>False</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Interaction Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Fix Imbalance</td>
      <td>False</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Fix Imbalance Method</td>
      <td>SMOTE</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d16225a1-2147-40a8-8f79-2a0b3b6a33ae')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d16225a1-2147-40a8-8f79-2a0b3b6a33ae button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d16225a1-2147-40a8-8f79-2a0b3b6a33ae');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
top3 = compare_models(n_select=3, sort="Accuracy")
```



  <div id="df-15e3380f-6fa4-444e-a79f-b7727dca0c02">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>AUC</th>
      <th>Recall</th>
      <th>Prec.</th>
      <th>F1</th>
      <th>Kappa</th>
      <th>MCC</th>
      <th>TT (Sec)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>lr</th>
      <td>Logistic Regression</td>
      <td>0.6237</td>
      <td>0.6186</td>
      <td>0.6714</td>
      <td>0.6512</td>
      <td>0.6534</td>
      <td>0.2334</td>
      <td>0.2387</td>
      <td>0.080</td>
    </tr>
    <tr>
      <th>ridge</th>
      <td>Ridge Classifier</td>
      <td>0.6167</td>
      <td>0.0000</td>
      <td>0.6143</td>
      <td>0.6640</td>
      <td>0.6336</td>
      <td>0.2256</td>
      <td>0.2284</td>
      <td>0.018</td>
    </tr>
    <tr>
      <th>lightgbm</th>
      <td>Light Gradient Boosting Machine</td>
      <td>0.6122</td>
      <td>0.5691</td>
      <td>0.8952</td>
      <td>0.6050</td>
      <td>0.7180</td>
      <td>0.1727</td>
      <td>0.1811</td>
      <td>0.038</td>
    </tr>
    <tr>
      <th>knn</th>
      <td>K Neighbors Classifier</td>
      <td>0.5974</td>
      <td>0.5937</td>
      <td>0.6905</td>
      <td>0.6328</td>
      <td>0.6416</td>
      <td>0.1811</td>
      <td>0.1977</td>
      <td>0.137</td>
    </tr>
    <tr>
      <th>gbc</th>
      <td>Gradient Boosting Classifier</td>
      <td>0.5917</td>
      <td>0.6098</td>
      <td>0.6595</td>
      <td>0.6245</td>
      <td>0.6301</td>
      <td>0.1670</td>
      <td>0.1765</td>
      <td>0.090</td>
    </tr>
    <tr>
      <th>rf</th>
      <td>Random Forest Classifier</td>
      <td>0.5910</td>
      <td>0.5958</td>
      <td>0.6238</td>
      <td>0.6152</td>
      <td>0.6086</td>
      <td>0.1625</td>
      <td>0.1630</td>
      <td>0.480</td>
    </tr>
    <tr>
      <th>dt</th>
      <td>Decision Tree Classifier</td>
      <td>0.5821</td>
      <td>0.5475</td>
      <td>0.6048</td>
      <td>0.6233</td>
      <td>0.6098</td>
      <td>0.1561</td>
      <td>0.1595</td>
      <td>0.022</td>
    </tr>
    <tr>
      <th>et</th>
      <td>Extra Trees Classifier</td>
      <td>0.5750</td>
      <td>0.6276</td>
      <td>0.6095</td>
      <td>0.6037</td>
      <td>0.5939</td>
      <td>0.1303</td>
      <td>0.1322</td>
      <td>0.471</td>
    </tr>
    <tr>
      <th>lda</th>
      <td>Linear Discriminant Analysis</td>
      <td>0.5571</td>
      <td>0.6200</td>
      <td>0.5214</td>
      <td>0.5946</td>
      <td>0.5476</td>
      <td>0.1134</td>
      <td>0.1146</td>
      <td>0.032</td>
    </tr>
    <tr>
      <th>dummy</th>
      <td>Dummy Classifier</td>
      <td>0.5487</td>
      <td>0.5000</td>
      <td>1.0000</td>
      <td>0.5487</td>
      <td>0.7081</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.011</td>
    </tr>
    <tr>
      <th>nb</th>
      <td>Naive Bayes</td>
      <td>0.5423</td>
      <td>0.6338</td>
      <td>0.3643</td>
      <td>0.6050</td>
      <td>0.4441</td>
      <td>0.1151</td>
      <td>0.1149</td>
      <td>0.022</td>
    </tr>
    <tr>
      <th>qda</th>
      <td>Quadratic Discriminant Analysis</td>
      <td>0.5404</td>
      <td>0.5300</td>
      <td>0.6000</td>
      <td>0.5748</td>
      <td>0.5677</td>
      <td>0.0623</td>
      <td>0.0647</td>
      <td>0.027</td>
    </tr>
    <tr>
      <th>svm</th>
      <td>SVM - Linear Kernel</td>
      <td>0.5327</td>
      <td>0.0000</td>
      <td>0.5524</td>
      <td>0.4947</td>
      <td>0.4852</td>
      <td>0.0817</td>
      <td>0.0888</td>
      <td>0.021</td>
    </tr>
    <tr>
      <th>ada</th>
      <td>Ada Boost Classifier</td>
      <td>0.5179</td>
      <td>0.5548</td>
      <td>0.6000</td>
      <td>0.5534</td>
      <td>0.5701</td>
      <td>0.0183</td>
      <td>0.0152</td>
      <td>0.113</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-15e3380f-6fa4-444e-a79f-b7727dca0c02')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-15e3380f-6fa4-444e-a79f-b7727dca0c02 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-15e3380f-6fa4-444e-a79f-b7727dca0c02');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
top3_tuned = [ tune_model(n) for n in top3 ]
```



  <div id="df-635012a6-18f7-4716-8d69-09c9d9decfc5">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Accuracy</th>
      <th>AUC</th>
      <th>Recall</th>
      <th>Prec.</th>
      <th>F1</th>
      <th>Kappa</th>
      <th>MCC</th>
    </tr>
    <tr>
      <th>Fold</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.8462</td>
      <td>0.8571</td>
      <td>1.0000</td>
      <td>0.7778</td>
      <td>0.8750</td>
      <td>0.6829</td>
      <td>0.7201</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.7692</td>
      <td>0.8452</td>
      <td>1.0000</td>
      <td>0.7000</td>
      <td>0.8235</td>
      <td>0.5185</td>
      <td>0.5916</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.5385</td>
      <td>0.4762</td>
      <td>0.8571</td>
      <td>0.5455</td>
      <td>0.6667</td>
      <td>0.0250</td>
      <td>0.0329</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.6154</td>
      <td>0.4405</td>
      <td>0.8571</td>
      <td>0.6000</td>
      <td>0.7059</td>
      <td>0.1975</td>
      <td>0.2254</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.4167</td>
      <td>0.4306</td>
      <td>0.3333</td>
      <td>0.4000</td>
      <td>0.3636</td>
      <td>-0.1667</td>
      <td>-0.1690</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5833</td>
      <td>0.5833</td>
      <td>0.8333</td>
      <td>0.5556</td>
      <td>0.6667</td>
      <td>0.1667</td>
      <td>0.1925</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.7500</td>
      <td>0.6714</td>
      <td>0.7143</td>
      <td>0.8333</td>
      <td>0.7692</td>
      <td>0.5000</td>
      <td>0.5071</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.4167</td>
      <td>0.4429</td>
      <td>0.5714</td>
      <td>0.5000</td>
      <td>0.5333</td>
      <td>-0.2353</td>
      <td>-0.2390</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.6667</td>
      <td>0.6571</td>
      <td>0.5714</td>
      <td>0.8000</td>
      <td>0.6667</td>
      <td>0.3514</td>
      <td>0.3714</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.7500</td>
      <td>0.6714</td>
      <td>0.8571</td>
      <td>0.7500</td>
      <td>0.8000</td>
      <td>0.4706</td>
      <td>0.4781</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>0.6353</td>
      <td>0.6076</td>
      <td>0.7595</td>
      <td>0.6462</td>
      <td>0.6871</td>
      <td>0.2511</td>
      <td>0.2711</td>
    </tr>
    <tr>
      <th>Std</th>
      <td>0.1406</td>
      <td>0.1528</td>
      <td>0.2010</td>
      <td>0.1386</td>
      <td>0.1426</td>
      <td>0.2916</td>
      <td>0.3053</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-635012a6-18f7-4716-8d69-09c9d9decfc5')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-635012a6-18f7-4716-8d69-09c9d9decfc5 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-635012a6-18f7-4716-8d69-09c9d9decfc5');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
top3_blend = blend_models(estimator_list=top3_tuned)
```



  <div id="df-23552801-a82c-4b7a-8660-f709ea0cbeb6">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Accuracy</th>
      <th>AUC</th>
      <th>Recall</th>
      <th>Prec.</th>
      <th>F1</th>
      <th>Kappa</th>
      <th>MCC</th>
    </tr>
    <tr>
      <th>Fold</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.7692</td>
      <td>0.0</td>
      <td>1.0000</td>
      <td>0.7000</td>
      <td>0.8235</td>
      <td>0.5185</td>
      <td>0.5916</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.6923</td>
      <td>0.0</td>
      <td>0.8571</td>
      <td>0.6667</td>
      <td>0.7500</td>
      <td>0.3659</td>
      <td>0.3858</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.3846</td>
      <td>0.0</td>
      <td>0.5714</td>
      <td>0.4444</td>
      <td>0.5000</td>
      <td>-0.2683</td>
      <td>-0.2829</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.6923</td>
      <td>0.0</td>
      <td>0.8571</td>
      <td>0.6667</td>
      <td>0.7500</td>
      <td>0.3659</td>
      <td>0.3858</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.5000</td>
      <td>0.0</td>
      <td>0.3333</td>
      <td>0.5000</td>
      <td>0.4000</td>
      <td>0.0000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5833</td>
      <td>0.0</td>
      <td>0.8333</td>
      <td>0.5556</td>
      <td>0.6667</td>
      <td>0.1667</td>
      <td>0.1925</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.7500</td>
      <td>0.0</td>
      <td>0.7143</td>
      <td>0.8333</td>
      <td>0.7692</td>
      <td>0.5000</td>
      <td>0.5071</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.6667</td>
      <td>0.0</td>
      <td>0.7143</td>
      <td>0.7143</td>
      <td>0.7143</td>
      <td>0.3143</td>
      <td>0.3143</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.6667</td>
      <td>0.0</td>
      <td>0.7143</td>
      <td>0.7143</td>
      <td>0.7143</td>
      <td>0.3143</td>
      <td>0.3143</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.7500</td>
      <td>0.0</td>
      <td>0.8571</td>
      <td>0.7500</td>
      <td>0.8000</td>
      <td>0.4706</td>
      <td>0.4781</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>0.6455</td>
      <td>0.0</td>
      <td>0.7452</td>
      <td>0.6545</td>
      <td>0.6888</td>
      <td>0.2748</td>
      <td>0.2886</td>
    </tr>
    <tr>
      <th>Std</th>
      <td>0.1164</td>
      <td>0.0</td>
      <td>0.1769</td>
      <td>0.1133</td>
      <td>0.1286</td>
      <td>0.2346</td>
      <td>0.2480</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-23552801-a82c-4b7a-8660-f709ea0cbeb6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-23552801-a82c-4b7a-8660-f709ea0cbeb6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-23552801-a82c-4b7a-8660-f709ea0cbeb6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
final_model = finalize_model(top3_blend)
```


```python
pred = predict_model(final_model, data = df_Capital.iloc[-20:])
```



  <div id="df-e452263e-1349-4346-a378-75c4e5b3013d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>AUC</th>
      <th>Recall</th>
      <th>Prec.</th>
      <th>F1</th>
      <th>Kappa</th>
      <th>MCC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Voting Classifier</td>
      <td>0.65</td>
      <td>0.7308</td>
      <td>1.0</td>
      <td>0.5</td>
      <td>0.6667</td>
      <td>0.375</td>
      <td>0.4804</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e452263e-1349-4346-a378-75c4e5b3013d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e452263e-1349-4346-a378-75c4e5b3013d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e452263e-1349-4346-a378-75c4e5b3013d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




```python
df_Capital
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>결과</th>
      <th>삼성화재_송희채</th>
      <th>삼성화재_고준용</th>
      <th>우리카드_조근호</th>
      <th>OK저축은행_배인호</th>
      <th>KB손해보험_양희준</th>
      <th>우리카드_김은섭</th>
      <th>한국전력_가빈</th>
      <th>우리카드_유광우</th>
      <th>우리카드_하승우</th>
      <th>...</th>
      <th>한국전력_서재덕</th>
      <th>KB손해보험_하현용</th>
      <th>삼성화재_이현우</th>
      <th>OK금융그룹_전진선</th>
      <th>팀명_KB손해보험</th>
      <th>팀명_OK금융그룹</th>
      <th>팀명_대한항공</th>
      <th>팀명_삼성화재</th>
      <th>팀명_우리카드</th>
      <th>팀명_한국전력</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>173</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>174</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>175</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>176</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>177</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>178 rows × 324 columns</p>
</div>




```python
def make_model(df_club):
    X = df_club.drop('결과',axis=1)
    y = df_club['결과']
    
    from sklearn.model_selection import train_test_split

    X_train, X_test, y_train, y_test = train_test_split(
        X,
        y,
    )
    
    from sklearn.neighbors import KNeighborsClassifier
    from sklearn.linear_model import LogisticRegression
    from sklearn.tree import DecisionTreeClassifier

    knn1 = KNeighborsClassifier(n_neighbors=5)
    knn2 = KNeighborsClassifier(n_neighbors=3)
    lr = LogisticRegression(max_iter=10000)
    dt3 = DecisionTreeClassifier(max_depth=3)
    dt5 = DecisionTreeClassifier(max_depth=5)

    from sklearn.ensemble import VotingClassifier
    hard = VotingClassifier([('knn1', knn1), ('knn2', knn2), ('lr',lr), 
                            ('dt3',dt3), ('dt5',dt5)])
    soft = VotingClassifier([('knn1', knn1), ('knn2',knn2), ('lr',lr), 
                            ('dt3',dt3), ('dt5',dt5)], voting='soft')

    names = ['hard', 'soft', 'knn1', 'knn2', 'lr', 'dt3', 'dt5']
    for idx, model in enumerate([hard, soft, knn1, knn2, lr, dt3, dt5]):
        model.fit(X_train, y_train)
        name = names[idx]
        train_score = model.score(X_train, y_train) * 100
        test_score = model.score(X_test, y_test) * 100
        print(f'{name} Train Accuracy:{train_score:.2f}%')
        print(f'{name} Test Accuracy:{test_score:.2f}%')    
        print()
    
    return(X, y)
    
```


```python


print('현대캐피탈 상대 선수 학습')
X_Capital, y_Capital = make_model(df_Capital)
print('대한항공 상대 선수 학습')
X_korea, y_korea = make_model(df_korea)
print('KB손해보험 상대 선수 학습')
X_KB, y_KB = make_model(df_KB)
print('삼성화재 상대 선수 학습')
X_Sam, y_Sam = make_model(df_Sam)
print('OK금융그룹 상대 선수 학습')
X_OK, y_OK = make_model(df_OK)
print('한국전력 상대 선수 학습')
X_KoreaE, y_KoreaE = make_model(df_KoreaE)
print('우리카드 상대 선수 학습')
X_Woori, y_Woori = make_model(df_Woori)
```

    현대캐피탈 상대 선수 학습
    hard Train Accuracy:80.45%
    hard Test Accuracy:51.11%
    
    soft Train Accuracy:81.95%
    soft Test Accuracy:53.33%
    
    knn1 Train Accuracy:71.43%
    knn1 Test Accuracy:51.11%
    
    knn2 Train Accuracy:75.19%
    knn2 Test Accuracy:53.33%
    
    lr Train Accuracy:92.48%
    lr Test Accuracy:48.89%
    
    dt3 Train Accuracy:72.93%
    dt3 Test Accuracy:57.78%
    
    dt5 Train Accuracy:78.95%
    dt5 Test Accuracy:46.67%
    
    대한항공 상대 선수 학습
    hard Train Accuracy:79.41%
    hard Test Accuracy:71.74%
    
    soft Train Accuracy:79.41%
    soft Test Accuracy:71.74%
    
    knn1 Train Accuracy:75.00%
    knn1 Test Accuracy:67.39%
    
    knn2 Train Accuracy:75.74%
    knn2 Test Accuracy:65.22%
    
    lr Train Accuracy:87.50%
    lr Test Accuracy:69.57%
    
    dt3 Train Accuracy:77.21%
    dt3 Test Accuracy:69.57%
    
    dt5 Train Accuracy:78.68%
    dt5 Test Accuracy:67.39%
    
    KB손해보험 상대 선수 학습
    hard Train Accuracy:82.81%
    hard Test Accuracy:53.49%
    
    soft Train Accuracy:84.38%
    soft Test Accuracy:55.81%
    
    knn1 Train Accuracy:74.22%
    knn1 Test Accuracy:51.16%
    
    knn2 Train Accuracy:77.34%
    knn2 Test Accuracy:53.49%
    
    lr Train Accuracy:96.09%
    lr Test Accuracy:55.81%
    
    dt3 Train Accuracy:70.31%
    dt3 Test Accuracy:53.49%
    
    dt5 Train Accuracy:75.78%
    dt5 Test Accuracy:46.51%
    
    삼성화재 상대 선수 학습
    hard Train Accuracy:85.16%
    hard Test Accuracy:53.49%
    
    soft Train Accuracy:88.28%
    soft Test Accuracy:60.47%
    
    knn1 Train Accuracy:77.34%
    knn1 Test Accuracy:65.12%
    
    knn2 Train Accuracy:83.59%
    knn2 Test Accuracy:74.42%
    
    lr Train Accuracy:94.53%
    lr Test Accuracy:51.16%
    
    dt3 Train Accuracy:66.41%
    dt3 Test Accuracy:41.86%
    
    dt5 Train Accuracy:75.78%
    dt5 Test Accuracy:51.16%
    
    OK금융그룹 상대 선수 학습
    hard Train Accuracy:79.84%
    hard Test Accuracy:62.79%
    
    soft Train Accuracy:82.17%
    soft Test Accuracy:58.14%
    
    knn1 Train Accuracy:71.32%
    knn1 Test Accuracy:55.81%
    
    knn2 Train Accuracy:75.19%
    knn2 Test Accuracy:51.16%
    
    lr Train Accuracy:91.47%
    lr Test Accuracy:60.47%
    
    dt3 Train Accuracy:65.89%
    dt3 Test Accuracy:51.16%
    
    dt5 Train Accuracy:72.09%
    dt5 Test Accuracy:55.81%
    
    한국전력 상대 선수 학습
    hard Train Accuracy:81.75%
    hard Test Accuracy:61.90%
    
    soft Train Accuracy:83.33%
    soft Test Accuracy:61.90%
    
    knn1 Train Accuracy:74.60%
    knn1 Test Accuracy:66.67%
    
    knn2 Train Accuracy:77.78%
    knn2 Test Accuracy:64.29%
    
    lr Train Accuracy:96.83%
    lr Test Accuracy:69.05%
    
    dt3 Train Accuracy:73.02%
    dt3 Test Accuracy:59.52%
    
    dt5 Train Accuracy:78.57%
    dt5 Test Accuracy:66.67%
    
    우리카드 상대 선수 학습
    hard Train Accuracy:82.71%
    hard Test Accuracy:60.00%
    
    soft Train Accuracy:84.21%
    soft Test Accuracy:57.78%
    
    knn1 Train Accuracy:78.20%
    knn1 Test Accuracy:66.67%
    
    knn2 Train Accuracy:82.71%
    knn2 Test Accuracy:60.00%
    
    lr Train Accuracy:93.98%
    lr Test Accuracy:53.33%
    
    dt3 Train Accuracy:72.18%
    dt3 Test Accuracy:68.89%
    
    dt5 Train Accuracy:79.70%
    dt5 Test Accuracy:53.33%
    
    


```python

```

# 3, 4월달 경기 전체 예측


```python
test_df = pd.read_csv('./남자/Male(2022_34)_volleyball_018.csv')
test_df = test_df[test_df['스타팅멤버'] == 1]
```


```python
test_df['이름'] = test_df['팀명'] + "_" + test_df['이름']
```


```python
test_df = test_df.groupby(['경기날짜', '팀명'])[['이름', '결과']].agg({'이름' : lambda data : ' '.join(data), '결과' : any})
test_df = pd.DataFrame(test_df).reset_index()
test_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>경기날짜</th>
      <th>팀명</th>
      <th>이름</th>
      <th>결과</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-03-05</td>
      <td>대한항공</td>
      <td>대한항공_링컨 대한항공_정지석 대한항공_곽승석 대한항공_진성태 대한항공_김규민 대한...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-03-05</td>
      <td>삼성화재</td>
      <td>삼성화재_러셀 삼성화재_신장호 삼성화재_황경민 삼성화재_한상길</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-03-06</td>
      <td>한국전력</td>
      <td>한국전력_다우디 한국전력_신영석 한국전력_임성진 한국전력_이시몬 한국전력_조근호 한...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022-03-06</td>
      <td>현대캐피탈</td>
      <td>현대캐피탈_허수봉 현대캐피탈_전광인 현대캐피탈_김선호 현대캐피탈_박상하 현대캐피탈_...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022-03-07</td>
      <td>OK금융그룹</td>
      <td>OK금융그룹_레오 OK금융그룹_차지환 OK금융그룹_조재성 OK금융그룹_진상헌 OK금...</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.set_option('mode.chained_assignment',  None) 
for i in range(len(test_df)):
    test_df['이름'][i] = ' '.join(test_df['이름'][i].split()[:6])
    
test_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>경기날짜</th>
      <th>팀명</th>
      <th>이름</th>
      <th>결과</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-03-05</td>
      <td>대한항공</td>
      <td>대한항공_링컨 대한항공_정지석 대한항공_곽승석 대한항공_진성태 대한항공_김규민 대한...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-03-05</td>
      <td>삼성화재</td>
      <td>삼성화재_러셀 삼성화재_신장호 삼성화재_황경민 삼성화재_한상길</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-03-06</td>
      <td>한국전력</td>
      <td>한국전력_다우디 한국전력_신영석 한국전력_임성진 한국전력_이시몬 한국전력_조근호 한...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022-03-06</td>
      <td>현대캐피탈</td>
      <td>현대캐피탈_허수봉 현대캐피탈_전광인 현대캐피탈_김선호 현대캐피탈_박상하 현대캐피탈_...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022-03-07</td>
      <td>OK금융그룹</td>
      <td>OK금융그룹_레오 OK금융그룹_차지환 OK금융그룹_조재성 OK금융그룹_진상헌 OK금...</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 경기번호 추가
import numpy as np
total = test_df.shape[0] // 2
test_df['경기번호'] = np.array([[i,i] for i in range(1, total+1)]).flatten()
test_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>경기날짜</th>
      <th>팀명</th>
      <th>이름</th>
      <th>결과</th>
      <th>경기번호</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-03-05</td>
      <td>대한항공</td>
      <td>대한항공_링컨 대한항공_정지석 대한항공_곽승석 대한항공_진성태 대한항공_김규민 대한...</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-03-05</td>
      <td>삼성화재</td>
      <td>삼성화재_러셀 삼성화재_신장호 삼성화재_황경민 삼성화재_한상길</td>
      <td>False</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-03-06</td>
      <td>한국전력</td>
      <td>한국전력_다우디 한국전력_신영석 한국전력_임성진 한국전력_이시몬 한국전력_조근호 한...</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022-03-06</td>
      <td>현대캐피탈</td>
      <td>현대캐피탈_허수봉 현대캐피탈_전광인 현대캐피탈_김선호 현대캐피탈_박상하 현대캐피탈_...</td>
      <td>False</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022-03-07</td>
      <td>OK금융그룹</td>
      <td>OK금융그룹_레오 OK금융그룹_차지환 OK금융그룹_조재성 OK금융그룹_진상헌 OK금...</td>
      <td>True</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_Capital_test = df_train('현대캐피탈', test_df, 1, X_Capital)
df_korea = df_train('대한항공', test_df, 1, X_korea)
df_KB_test = df_train('KB손해보험', test_df, 1, X_KB)
df_Sam_test = df_train('삼성화재', test_df, 1, X_Sam)
df_OK_test = df_train('OK금융그룹', test_df, 1, X_OK)
df_KoreaE_test = df_train('한국전력', test_df, 1, X_KoreaE)
df_Woori_test = df_train('우리카드', test_df, 1, X_Woori)



```

    0
    0
    0
    0
    0
    0
    0
    


```python
def answer(df_t, X, y):
    X_test = df_t.drop('결과',axis=1)
    y_test = df_t['결과']
    from sklearn.neighbors import KNeighborsClassifier
    from sklearn.linear_model import LogisticRegression
    from sklearn.tree import DecisionTreeClassifier

    knn1 = KNeighborsClassifier(n_neighbors=5)
    knn2 = KNeighborsClassifier(n_neighbors=3)
    lr = LogisticRegression(max_iter=10000)
    dt3 = DecisionTreeClassifier(max_depth=3)
    dt5 = DecisionTreeClassifier(max_depth=5)

    from sklearn.ensemble import VotingClassifier
    hard = VotingClassifier([('knn1', knn1), ('knn2', knn2), ('lr',lr), 
                            ('dt3',dt3), ('dt5',dt5)])
    soft = VotingClassifier([('knn1', knn1), ('knn2',knn2), ('lr',lr), 
                            ('dt3',dt3), ('dt5',dt5)], voting='soft')

    names = ['hard', 'soft', 'knn1', 'knn2', 'lr', 'dt3', 'dt5']
    for idx, model in enumerate([hard, soft, knn1, knn2, lr, dt3, dt5]):
        model.fit(X, y)
        name = names[idx]
        train_score = model.score(X, y) * 100
        test_score = model.score(X_test, y_test) * 100
        pred = model.predict(X_test)
        print(f'{name} Train Accuracy:{train_score:.2f}%')
        print(f'{name} Test Accuracy:{test_score:.2f}%')    
        print(f'{name} 예측값: {pred}')
        print()
    

```

# 현대캐피탈 3, 4월 예측 값


```python
answer(df_Capital_test, X_Capital, y_Capital)
```

    hard Train Accuracy:74.72%
    hard Test Accuracy:71.43%
    hard 예측값: [1 0 0 1 1 1 1]
    
    soft Train Accuracy:79.78%
    soft Test Accuracy:57.14%
    soft 예측값: [1 0 1 1 1 1 1]
    
    knn1 Train Accuracy:70.22%
    knn1 Test Accuracy:71.43%
    knn1 예측값: [0 0 1 1 0 0 1]
    
    knn2 Train Accuracy:77.53%
    knn2 Test Accuracy:57.14%
    knn2 예측값: [1 0 1 1 1 1 1]
    
    lr Train Accuracy:89.33%
    lr Test Accuracy:71.43%
    lr 예측값: [1 0 0 1 1 1 1]
    
    dt3 Train Accuracy:70.79%
    dt3 Test Accuracy:71.43%
    dt3 예측값: [1 0 0 1 1 1 1]
    
    dt5 Train Accuracy:73.03%
    dt5 Test Accuracy:71.43%
    dt5 예측값: [1 0 0 1 1 1 1]
    
    

# 대한항공 3, 4월 예측 값


```python
answer(df_korea, X_korea, y_korea)
```

    hard Train Accuracy:79.12%
    hard Test Accuracy:63.64%
    hard 예측값: [1 1 1 0 1 1 1 1 0 0 0]
    
    soft Train Accuracy:79.12%
    soft Test Accuracy:72.73%
    soft 예측값: [1 1 1 0 1 1 1 1 1 1 1]
    
    knn1 Train Accuracy:75.82%
    knn1 Test Accuracy:63.64%
    knn1 예측값: [1 1 1 0 1 1 1 1 0 0 0]
    
    knn2 Train Accuracy:78.57%
    knn2 Test Accuracy:63.64%
    knn2 예측값: [1 1 1 0 1 1 1 1 0 0 0]
    
    lr Train Accuracy:85.71%
    lr Test Accuracy:63.64%
    lr 예측값: [1 0 1 0 0 1 1 1 0 0 0]
    
    dt3 Train Accuracy:75.82%
    dt3 Test Accuracy:72.73%
    dt3 예측값: [1 1 1 0 1 1 1 1 1 1 1]
    
    dt5 Train Accuracy:76.92%
    dt5 Test Accuracy:72.73%
    dt5 예측값: [1 1 1 0 1 1 1 1 1 1 1]
    
    

# KB손해보험 3, 4월 예측 값


```python
answer(df_KB_test, X_KB, y_KB)
```

    hard Train Accuracy:79.53%
    hard Test Accuracy:72.73%
    hard 예측값: [1 1 1 0 0 0 0 0 0 0 0]
    
    soft Train Accuracy:84.80%
    soft Test Accuracy:63.64%
    soft 예측값: [1 0 1 0 0 0 0 0 0 0 0]
    
    knn1 Train Accuracy:71.93%
    knn1 Test Accuracy:63.64%
    knn1 예측값: [1 1 1 0 0 1 0 0 0 0 0]
    
    knn2 Train Accuracy:78.36%
    knn2 Test Accuracy:72.73%
    knn2 예측값: [1 1 1 0 0 0 0 0 0 0 0]
    
    lr Train Accuracy:94.74%
    lr Test Accuracy:72.73%
    lr 예측값: [1 1 1 0 0 0 0 0 0 0 0]
    
    dt3 Train Accuracy:66.08%
    dt3 Test Accuracy:45.45%
    dt3 예측값: [0 0 0 0 0 0 0 0 0 0 0]
    
    dt5 Train Accuracy:69.01%
    dt5 Test Accuracy:45.45%
    dt5 예측값: [0 0 0 0 0 0 0 0 0 0 0]
    
    

# 삼성화재 3, 4월 예측 값


```python
answer(df_Sam_test, X_Sam, y_Sam)
```

    hard Train Accuracy:84.80%
    hard Test Accuracy:62.50%
    hard 예측값: [0 0 0 0 1 0 0 1]
    
    soft Train Accuracy:85.96%
    soft Test Accuracy:75.00%
    soft 예측값: [0 0 0 0 1 0 1 1]
    
    knn1 Train Accuracy:76.02%
    knn1 Test Accuracy:62.50%
    knn1 예측값: [0 0 0 0 1 0 0 1]
    
    knn2 Train Accuracy:81.87%
    knn2 Test Accuracy:50.00%
    knn2 예측값: [0 0 1 0 1 0 0 1]
    
    lr Train Accuracy:94.74%
    lr Test Accuracy:62.50%
    lr 예측값: [0 0 0 0 1 1 1 1]
    
    dt3 Train Accuracy:61.99%
    dt3 Test Accuracy:87.50%
    dt3 예측값: [0 0 0 0 0 0 0 0]
    
    dt5 Train Accuracy:69.59%
    dt5 Test Accuracy:37.50%
    dt5 예측값: [0 1 1 0 1 1 1 1]
    
    

# OK금융그룹 3, 4월 예측 값


```python
answer(df_OK_test, X_OK, y_OK)
```

    hard Train Accuracy:81.98%
    hard Test Accuracy:57.14%
    hard 예측값: [0 0 0 1 1 0 1]
    
    soft Train Accuracy:86.63%
    soft Test Accuracy:57.14%
    soft 예측값: [0 0 0 1 1 0 1]
    
    knn1 Train Accuracy:76.16%
    knn1 Test Accuracy:57.14%
    knn1 예측값: [0 0 0 1 1 0 1]
    
    knn2 Train Accuracy:76.16%
    knn2 Test Accuracy:71.43%
    knn2 예측값: [0 0 0 1 1 0 0]
    
    lr Train Accuracy:91.28%
    lr Test Accuracy:57.14%
    lr 예측값: [1 1 0 1 1 0 1]
    
    dt3 Train Accuracy:59.88%
    dt3 Test Accuracy:71.43%
    dt3 예측값: [0 0 0 0 0 0 0]
    
    dt5 Train Accuracy:65.12%
    dt5 Test Accuracy:42.86%
    dt5 예측값: [1 1 1 1 1 0 1]
    
    

# 한국전력 3, 4월 예측 값


```python
answer(df_KoreaE_test, X_KoreaE, y_KoreaE)
```

    hard Train Accuracy:83.93%
    hard Test Accuracy:50.00%
    hard 예측값: [0 0 1 0 0 1 0 1 0 1]
    
    soft Train Accuracy:84.52%
    soft Test Accuracy:50.00%
    soft 예측값: [0 0 1 0 0 1 0 1 0 1]
    
    knn1 Train Accuracy:75.00%
    knn1 Test Accuracy:50.00%
    knn1 예측값: [1 0 0 0 0 1 0 1 0 1]
    
    knn2 Train Accuracy:80.36%
    knn2 Test Accuracy:70.00%
    knn2 예측값: [0 0 1 0 1 1 0 1 0 0]
    
    lr Train Accuracy:95.24%
    lr Test Accuracy:80.00%
    lr 예측값: [1 0 1 1 1 1 0 1 0 1]
    
    dt3 Train Accuracy:72.02%
    dt3 Test Accuracy:20.00%
    dt3 예측값: [0 0 0 0 0 0 0 0 0 1]
    
    dt5 Train Accuracy:76.19%
    dt5 Test Accuracy:30.00%
    dt5 예측값: [0 0 1 0 0 0 0 0 0 1]
    
    

# 우리카드 3, 4월 예측 값


```python
answer(df_Woori_test, X_Woori, y_Woori)
```

    hard Train Accuracy:83.71%
    hard Test Accuracy:62.50%
    hard 예측값: [0 0 0 0 1 1 1 1]
    
    soft Train Accuracy:84.27%
    soft Test Accuracy:62.50%
    soft 예측값: [0 0 0 0 1 1 1 1]
    
    knn1 Train Accuracy:76.97%
    knn1 Test Accuracy:62.50%
    knn1 예측값: [0 0 0 0 1 1 1 1]
    
    knn2 Train Accuracy:78.09%
    knn2 Test Accuracy:62.50%
    knn2 예측값: [0 0 0 0 1 1 1 1]
    
    lr Train Accuracy:91.57%
    lr Test Accuracy:62.50%
    lr 예측값: [0 0 0 0 1 1 1 1]
    
    dt3 Train Accuracy:73.60%
    dt3 Test Accuracy:50.00%
    dt3 예측값: [1 1 1 0 1 1 1 1]
    
    dt5 Train Accuracy:76.40%
    dt5 Test Accuracy:37.50%
    dt5 예측값: [1 1 1 1 1 1 1 1]
    
    

# 현대캐피탈 3, 4월 예측 값

hard Train Accuracy:74.72%
hard Test Accuracy:71.43%
hard 예측값: [1 0 0 1 1 1 1]

knn1 Train Accuracy:70.22%
knn1 Test Accuracy:71.43%
knn1 예측값: [0 0 1 1 0 0 1]

lr Train Accuracy:89.33%
lr Test Accuracy:71.43%
lr 예측값: [1 0 0 1 1 1 1]

dt3 Train Accuracy:70.79%
dt3 Test Accuracy:71.43%
dt3 예측값: [1 0 0 1 1 1 1]

dt5 Train Accuracy:73.03%
dt5 Test Accuracy:71.43%
dt5 예측값: [1 0 0 1 1 1 1]

### 총 7경기 정확도 71.43%

# 대한항공 3, 4월 예측 값



soft Train Accuracy:79.12%
soft Test Accuracy:72.73%
soft 예측값: [1 1 1 0 1 1 1 1 1 1 1]

dt3 Train Accuracy:75.82%
dt3 Test Accuracy:72.73%
dt3 예측값: [1 1 1 0 1 1 1 1 1 1 1]

dt5 Train Accuracy:76.92%
dt5 Test Accuracy:72.73%
dt5 예측값: [1 1 1 0 1 1 1 1 1 1 1]

### 총 11경기 정확도 72.73%


# KB손해보험 3, 4월 예측 값


hard Train Accuracy:79.53%
hard Test Accuracy:72.73%
hard 예측값: [1 1 1 0 0 0 0 0 0 0 0]

knn2 Train Accuracy:78.36%
knn2 Test Accuracy:72.73%
knn2 예측값: [1 1 1 0 0 0 0 0 0 0 0]

lr Train Accuracy:94.74%
lr Test Accuracy:72.73%
lr 예측값: [1 1 1 0 0 0 0 0 0 0 0]

### 총 11경기 정확도 72.73%


# 삼성화재 3, 4월 예측 값


soft Train Accuracy:85.96%
soft Test Accuracy:75.00%
soft 예측값: [0 0 0 0 1 0 1 1]

dt3 Train Accuracy:61.99%
dt3 Test Accuracy:87.50%
dt3 예측값: [0 0 0 0 0 0 0 0]

### 총 8경기 정확도 87.50%


# OK금융그룹 3, 4월 예측 값

knn2 Train Accuracy:76.16%
knn2 Test Accuracy:71.43%
knn2 예측값: [0 0 0 1 1 0 0]


dt3 Train Accuracy:59.88%
dt3 Test Accuracy:71.43%
dt3 예측값: [0 0 0 0 0 0 0]

### 총 7경기 정확도 71.43%


# 한국전력 3, 4월 예측 값



knn2 Train Accuracy:80.36%
knn2 Test Accuracy:70.00%
knn2 예측값: [0 0 1 0 1 1 0 1 0 0]

lr Train Accuracy:95.24%
lr Test Accuracy:80.00%
lr 예측값: [1 0 1 1 1 1 0 1 0 1]

### 총 10경기 정확도 80.00%



# 우리카드 3, 4월 예측 값

hard Train Accuracy:83.71%
hard Test Accuracy:62.50%
hard 예측값: [0 0 0 0 1 1 1 1]

soft Train Accuracy:84.27%
soft Test Accuracy:62.50%
soft 예측값: [0 0 0 0 1 1 1 1]

knn1 Train Accuracy:76.97%
knn1 Test Accuracy:62.50%
knn1 예측값: [0 0 0 0 1 1 1 1]

knn2 Train Accuracy:78.09%
knn2 Test Accuracy:62.50%
knn2 예측값: [0 0 0 0 1 1 1 1]

lr Train Accuracy:91.57%
lr Test Accuracy:62.50%
lr 예측값: [0 0 0 0 1 1 1 1]

### 총 8경기 정확도 62.50%

